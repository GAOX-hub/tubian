<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>生物密码子突变模拟器</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Microsoft YaHei", sans-serif;
      background: #e6f6ff;
      color: #111827;
    }
    .page-outer {
      max-width: 1100px;
      margin: 30px auto 40px;
      padding: 0 24px;
    }
    .page-wrap {
      background: #ffffff;
      border-radius: 26px;
      box-shadow: 0 20px 40px rgba(15, 23, 42, 0.15);
      padding: 26px 30px 32px;
    }
    header {
      text-align: center;
      margin-bottom: 22px;
    }
    header h1 {
      margin: 0 0 6px;
      font-size: 30px;
      font-weight: 800;
      color: #0a3d62;
    }
    header p {
      margin: 0;
      font-size: 14px;
      color: #4b5563;
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      color: #064e3b;
      margin: 0 0 10px;
    }

    .panel {
      background: #f9fefe;
      border-radius: 20px;
      border: 1px solid #e0f2f1;
      padding: 18px 20px 18px;
      margin-bottom: 18px;
    }

    .flex-row {
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
    }
    .flex-item {
      flex: 1 1 300px;
    }

    /* 原始密码子输入 */
    .orig-input-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin-bottom: 8px;
    }
    #orig-input {
      padding: 8px 12px;
      border-radius: 999px;
      border: 2px solid #bae6fd;
      font-size: 18px;
      width: 140px;
      text-transform: uppercase;
    }
    #set-orig-btn {
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: #0ea5e9;
      color: #ecfeff;
      font-size: 15px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(14,165,233,0.4);
    }

    /* 突变密码子选择 */
    .codon-select-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    select.codon-pos {
      padding: 6px 8px;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      font-size: 18px;
      width: 60px;
      text-align: center;
    }

    /* 结果显示 */
    .result-block {
      margin-top: 10px;
    }
    .result-line {
      font-size: 16px;
      margin: 6px 0;
    }
    .label-strong {
      font-weight: 700;
      color: #111827;
    }
    .tag {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 10px;
      background: linear-gradient(135deg,#e0f2ff,#bfdbfe);
      color: #1e3a8a;
      font-weight: 700;
      margin-left: 6px;
      min-width: 54px;
      text-align: center;
    }
    .tag-aa {
      background: linear-gradient(135deg,#dcfce7,#bbf7d0);
      color: #166534;
    }
    .mut-type {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 15px;
      margin-left: 8px;
    }
    .mut-syn { background:#ecfeff; color:#0369a1; border:1px solid #7dd3fc; }
    .mut-mis { background:#fef3c7; color:#92400e; border:1px solid #facc15; }
    .mut-non { background:#fee2e2; color:#b91c1c; border:1px solid #fca5a5; }
    .mut-stoploss { background:#ede9fe; color:#5b21b6; border:1px solid #c4b5fd; }
    .mut-none { background:#e5e7eb; color:#374151; border:1px solid #d1d5db; }

    @media (max-width: 720px) {
      .flex-row { flex-direction: column; }
    }
  </style>
</head>
<body>

<div class="page-outer">
  <div class="page-wrap">

    <header>
      <h1>生物密码子突变模拟器</h1>
      <p>修改三联体任意碱基，实时显示氨基酸变化与突变类型</p>
    </header>

    <div class="panel">
      <div class="flex-row">

        <!-- 原始密码子 -->
        <div class="flex-item">
          <h2 class="section-title">① 设置原始密码子（mRNA 5′→3′）</h2>

          <div class="orig-input-row">
            <input id="orig-input" type="text" maxlength="3" placeholder="例如 AUG">
            <button id="set-orig-btn">设为原始密码子</button>
          </div>
          <div id="error-msg" class="error"></div>

          <div class="result-block" id="orig-info" style="display:none;">
            <div class="result-line">
              <span class="label-strong">原始密码子：</span>
              <span id="orig-codon-tag" class="tag"></span>
            </div>
            <div class="result-line">
              <span class="label-strong">原始氨基酸：</span>
              <span id="orig-aa-tag" class="tag tag-aa"></span>
            </div>
          </div>
        </div>

        <!-- 突变密码子 -->
        <div class="flex-item">
          <h2 class="section-title">② 修改密码子产生突变</h2>

          <div class="codon-select-row">
            <label>突变后密码子：</label>
            <select id="pos1" class="codon-pos"><option>A</option><option>U</option><option>G</option><option>C</option></select>
            <select id="pos2" class="codon-pos"><option>A</option><option>U</option><option>G</option><option>C</option></select>
            <select id="pos3" class="codon-pos"><option>A</option><option>U</option><option>G</option><option>C</option></select>
          </div>

          <div class="result-block" id="mut-info" style="display:none;">
            <div class="result-line">
              <span class="label-strong">突变后密码子：</span>
              <span id="mut-codon-tag" class="tag"></span>
            </div>
            <div class="result-line">
              <span class="label-strong">突变后氨基酸：</span>
              <span id="mut-aa-tag" class="tag tag-aa"></span>
            </div>
            <div class="result-line">
              <span class="label-strong">突变类型：</span>
              <span id="mut-type-tag" class="mut-type mut-none">—</span>
            </div>
            <div id="mut-desc" style="font-size:14px;color:#4b5563;"></div>
          </div>
        </div>

      </div>
    </div>

  </div>
</div>

<script>
/* ========== 遗传密码表（RNA） ========== */
const TABLE={
"UUU":{aa:"Phe",name:"苯丙氨酸"}, "UUC":{aa:"Phe",name:"苯丙氨酸"},
"UUA":{aa:"Leu",name:"亮氨酸"}, "UUG":{aa:"Leu",name:"亮氨酸"},
"CUU":{aa:"Leu",name:"亮氨酸"}, "CUC":{aa:"Leu",name:"亮氨酸"},
"CUA":{aa:"Leu",name:"亮氨酸"}, "CUG":{aa:"Leu",name:"亮氨酸"},
"AUU":{aa:"Ile",name:"异亮氨酸"}, "AUC":{aa:"Ile",name:"异亮氨酸"},
"AUA":{aa:"Ile",name:"异亮氨酸"},
"AUG":{aa:"Met",name:"甲硫氨酸"},
"GUU":{aa:"Val",name:"缬氨酸"}, "GUC":{aa:"Val",name:"缬氨酸"},
"GUA":{aa:"Val",name:"缬氨酸"}, "GUG":{aa:"Val",name:"缬氨酸"},
"UCU":{aa:"Ser",name:"丝氨酸"}, "UCC":{aa:"Ser",name:"丝氨酸"},
"UCA":{aa:"Ser",name:"丝氨酸"}, "UCG":{aa:"Ser",name:"丝氨酸"},
"AGU":{aa:"Ser",name:"丝氨酸"}, "AGC":{aa:"Ser",name:"丝氨酸"},
"CCU":{aa:"Pro",name:"脯氨酸"}, "CCC":{aa:"Pro",name:"脯氨酸"},
"CCA":{aa:"Pro",name:"脯氨酸"}, "CCG":{aa:"Pro",name:"脯氨酸"},
"ACU":{aa:"Thr",name:"苏氨酸"}, "ACC":{aa:"Thr",name:"苏氨酸"},
"ACA":{aa:"Thr",name:"苏氨酸"}, "ACG":{aa:"Thr",name:"苏氨酸"},
"GCU":{aa:"Ala",name:"丙氨酸"}, "GCC":{aa:"Ala",name:"丙氨酸"},
"GCA":{aa:"Ala",name:"丙氨酸"}, "GCG":{aa:"Ala",name:"丙氨酸"},
"UAU":{aa:"Tyr",name:"酪氨酸"}, "UAC":{aa:"Tyr",name:"酪氨酸"},
"UAA":{aa:"Stop",name:"终止密码子"},
"UAG":{aa:"Stop",name:"终止密码子"},
"UGA":{aa:"Stop",name:"终止密码子"},
"UGU":{aa:"Cys",name:"半胱氨酸"}, "UGC":{aa:"Cys",name:"半胱氨酸"},
"UGG":{aa:"Trp",name:"色氨酸"},
"CAA":{aa:"Gln",name:"谷氨酰胺"}, "CAG":{aa:"Gln",name:"谷氨酰胺"},
"CAU":{aa:"His",name:"组氨酸"}, "CAC":{aa:"His",name:"组氨酸"},
"AAA":{aa:"Lys",name:"赖氨酸"}, "AAG":{aa:"Lys",name:"赖氨酸"},
"AAU":{aa:"Asn",name:"天冬酰胺"}, "AAC":{aa:"Asn",name:"天冬酰胺"},
"GAU":{aa:"Asp",name:"天冬氨酸"}, "GAC":{aa:"Asp",name:"天冬氨酸"},
"GAA":{aa:"Glu",name:"谷氨酸"}, "GAG":{aa:"Glu",name:"谷氨酸"},
"CGU":{aa:"Arg",name:"精氨酸"}, "CGC":{aa:"Arg",name:"精氨酸"},
"CGA":{aa:"Arg",name:"精氨酸"}, "CGG":{aa:"Arg",name:"精氨酸"},
"AGA":{aa:"Arg",name:"精氨酸"}, "AGG":{aa:"Arg",name:"精氨酸"},
"GGU":{aa:"Gly",name:"甘氨酸"}, "GGC":{aa:"Gly",name:"甘氨酸"},
"GGA":{aa:"Gly",name:"甘氨酸"}, "GGG":{aa:"Gly",name:"甘氨酸"}
};

let originalCodon = "AUG";

function normalize(raw){
  if(!raw) return {ok:false,error:"请输入 3 个碱基"};
  let s=raw.trim().toUpperCase();
  if(s.length!==3) return {ok:false,error:"长度必须为 3"};
  s=s.replace(/T/g,"U");
  if(!/^[AUCG]{3}$/.test(s)) return {ok:false,error:"只允许 A/U/C/G（或含 T 的 DNA 密码子）"};
  return {ok:true,codon:s};
}

function getInfo(c){
  const x=TABLE[c];
  if(!x) return null;
  return {aa:x.aa,name:x.name,isStop:x.aa==="Stop",label:x.aa==="Stop"?x.name:`${x.name} (${x.aa})`};
}

function setOriginal(){
  const raw=document.getElementById("orig-input").value;
  const res=normalize(raw);
  const err=document.getElementById("error-msg");
  const block=document.getElementById("orig-info");

  if(!res.ok){
    err.textContent=res.error;
    block.style.display="none";
    return;
  }

  const info=getInfo(res.codon);
  if(!info){
    err.textContent="未找到对应氨基酸";
    block.style.display="none";
    return;
  }

  err.textContent="";
  originalCodon=res.codon;

  document.getElementById("orig-codon-tag").textContent=originalCodon;
  document.getElementById("orig-aa-tag").textContent=info.label;
  block.style.display="block";

  document.getElementById("pos1").value=originalCodon[0];
  document.getElementById("pos2").value=originalCodon[1];
  document.getElementById("pos3").value=originalCodon[2];

  updateMutation();
}

function updateMutation(){
  const mut=document.getElementById("pos1").value+
    document.getElementById("pos2").value+
    document.getElementById("pos3").value;

  const origInfo=getInfo(originalCodon);
  const mutInfo=getInfo(mut);

  const block=document.getElementById("mut-info");
  if(!origInfo||!mutInfo){
    block.style.display="none";return;
  }
  block.style.display="block";

  document.getElementById("mut-codon-tag").textContent=mut;
  document.getElementById("mut-aa-tag").textContent=mutInfo.label;

  let type="",cls="mut-none",desc="";

  if(mut===originalCodon){
    type="未发生突变";
    desc="密码子不变，氨基酸保持不变";
  }
  else if(!origInfo.isStop && mutInfo.isStop){
    type="无义突变"; cls="mut-non";
    desc="突变后成为终止密码子，提前终止翻译";
  }
  else if(origInfo.isStop && !mutInfo.isStop){
    type="终止丢失"; cls="mut-stoploss";
    desc="原本是终止密码子，突变后不再终止";
  }
  else if(mutInfo.aa===origInfo.aa){
    type="同义突变"; cls="mut-syn";
    desc="密码子改变但氨基酸不变";
  }
  else{
    type="错义突变"; cls="mut-mis";
    desc="氨基酸改变，可能影响蛋白质功能";
  }

  const diff=[];
  for(let i=0;i<3;i++){
    if(originalCodon[i]!==mut[i]) diff.push(i+1);
  }
  if(diff.length) desc+=`（变化位置：第 ${diff.join("，第 ")} 位）`;

  const tt=document.getElementById("mut-type-tag");
  tt.className="mut-type "+cls;
  tt.textContent=type;
  document.getElementById("mut-desc").textContent=desc;
}

document.getElementById("set-orig-btn").onclick=setOriginal;
["pos1","pos2","pos3"].forEach(id=>{
  document.getElementById(id).onchange=updateMutation;
});

document.getElementById("orig-input").value="AUG";
setOriginal();
</script>
</body>
</html>
